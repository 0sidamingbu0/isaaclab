# Copyright (c) 2024-2025 Ocean BDX
# SPDX-License-Identifier: Apache-2.0
# OceanBDX Bipedal Robot Deployment Configuration
# Generated for Isaac Lab trained model

ocean/bipedal_walk:
  model_name: "policy.pt"
  num_observations: 57  # Updated for current model: IMU(3+3+4) + joints(10+10+10) + commands(3) + actions(10) + last_actions(10) = 57
  observations: ["ang_vel", "gravity_vec", "quaternion", "dof_pos", "dof_vel", "dof_torques", "commands", "actions"]
  observations_history: []  # 0 is the latest observation
  observations_history_priority: "time"  # "time" or "term" priority
  clip_obs: 100.0
  clip_actions_lower: [-100.0, -100.0, -100.0, -100.0, -100.0,   # Left leg: l1,l2,l3,l4,l5
                       -100.0, -100.0, -100.0, -100.0, -100.0,   # Right leg: r1,r2,r3,r4,r5  
                       -10.0, -10.0, -10.0, -10.0]               # Neck: n1,n2,n3,n4
  clip_actions_upper: [100.0, 100.0, 100.0, 100.0, 100.0,        # Left leg: l1,l2,l3,l4,l5
                       100.0, 100.0, 100.0, 100.0, 100.0,        # Right leg: r1,r2,r3,r4,r5
                       10.0, 10.0, 10.0, 10.0]                   # Neck: n1,n2,n3,n4
  rl_kp: [35.0, 35.0, 35.0, 35.0, 35.0,      # Left leg (matches Isaac Lab stiffness)
          35.0, 35.0, 35.0, 35.0, 35.0,      # Right leg (matches Isaac Lab stiffness)
          8.0, 8.0, 8.0, 8.0]                # Neck (matches Isaac Lab stiffness)
  rl_kd: [3.0, 3.0, 3.0, 3.0, 3.0,           # Left leg (matches Isaac Lab damping)
          3.0, 3.0, 3.0, 3.0, 3.0,           # Right leg (matches Isaac Lab damping)
          2.0, 2.0, 2.0, 2.0]                # Neck (matches Isaac Lab damping)
  fixed_kp: [40.0, 40.0, 40.0, 40.0, 40.0,   # Left leg (backup control)
             40.0, 40.0, 40.0, 40.0, 40.0,   # Right leg (backup control)
             10.0, 10.0, 10.0, 10.0]         # Neck (backup control)
  fixed_kd: [3.5, 3.5, 3.5, 3.5, 3.5,        # Left leg (backup control)
             3.5, 3.5, 3.5, 3.5, 3.5,        # Right leg (backup control)
             2.5, 2.5, 2.5, 2.5]             # Neck (backup control)
  num_of_dofs: 14
  action_scale: [0.4, 0.4, 0.4, 0.4, 0.4,  # Left leg (matches Isaac Lab action scale)
                 0.4, 0.4, 0.4, 0.4, 0.4,  # Right leg (matches Isaac Lab action scale)
                 0.2, 0.2, 0.2, 0.2]       # Neck (smaller scale for safety)
  wheel_indices: []  # No wheels for bipedal robot
  lin_vel_scale: 1.0     # Linear velocity command scaling
  ang_vel_scale: 0.5     # Angular velocity command scaling  
  dof_pos_scale: 1.0     # Joint position scaling
  dof_vel_scale: 0.05    # Joint velocity scaling
  commands_scale: [1.0, 1.0, 1.0]  # [lin_vel_x, lin_vel_y, ang_vel_z]
  torque_limits: [100.0, 100.0, 100.0, 100.0, 100.0,  # Left leg (matches Isaac Lab effort_limit)
                  100.0, 100.0, 100.0, 100.0, 100.0,  # Right leg (matches Isaac Lab effort_limit)
                  10.0, 10.0, 10.0, 10.0]             # Neck (matches Isaac Lab effort_limit)
  # Default standing pose (from URDF limits, middle range)
  default_dof_pos: [0.0, -0.244, -0.436, 0.270, 0.069,    # Left leg: l1(0), l2(-0.244), l3(-0.436), l4(0.270), l5(0.069)
                    0.0, -0.244, -0.436, 0.270, 0.069,    # Right leg: r1(0), r2(-0.244), r3(-0.436), r4(0.270), r5(0.069)
                    0.0, 0.0, 0.0, 0.0]                   # Neck: n1,n2,n3,n4 (neutral)
  # Joint mapping (Isaac Lab order: legs then neck)
  joint_mapping: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
  
  # Joint limits from URDF (in radians)
  joint_limits_lower: [-0.436, -0.750, -1.361, -0.803, -1.396,  # Left leg
                       -0.436, -0.750, -1.361, -0.803, -1.396,  # Right leg  
                       -1.0, -1.0, -1.0, -1.0]                  # Neck (estimated)
  joint_limits_upper: [0.349, 0.262, 0.489, 1.344, 1.134,      # Left leg
                       0.349, 0.262, 0.489, 1.344, 1.134,      # Right leg
                       1.0, 1.0, 1.0, 1.0]                     # Neck (estimated)
  
  # IMU configuration
  imu_frame: "imu_link"
  gravity_vector: [0.0, 0.0, -9.81]  # Standard gravity in NED frame
  
  # Control frequency
  control_frequency: 50  # Hz (matches Isaac Lab decimation=4 with 200Hz sim)
  
  # Safety parameters
  emergency_stop_conditions:
    max_joint_velocity: 50.0     # rad/s (matches Isaac Lab velocity_limit)
    max_joint_torque: 100.0      # Nm (matches Isaac Lab effort_limit)
    max_tilt_angle: 0.73         # rad (~42 degrees, matches termination)
    min_height: 0.2              # m (matches termination)
    max_height: 1.0              # m (safety limit)